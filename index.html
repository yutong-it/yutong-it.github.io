<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="yutong-it">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="yutong-it">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="yutong-it">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>yutong-it</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">yutong-it</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/31/salt工具学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/31/salt工具学习/" itemprop="url">salt工具学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-31T17:48:34+08:00">
                2019-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><strong>1、salt-key常用命令</strong></p>
</blockquote>
<p>master上证书查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`salt-key -L`</span><br></pre></td></tr></table></figure></p>
<p>查看没有接受的认证<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt-key -l pre</span><br></pre></td></tr></table></figure></p>
<p>接收所有的认证<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt-key -A</span><br></pre></td></tr></table></figure></p>
<p>接收某个认证或某些<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">salt-key -a host_key</span><br><span class="line">salt-key -a r*.cldisk1.*.net</span><br></pre></td></tr></table></figure></p>
<p>删除所有认证<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt-key -D</span><br></pre></td></tr></table></figure></p>
<p>删除某个认证或某些<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">salt-key -d host_key</span><br><span class="line">salt-key -d *web*</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>2、远程操作命令</strong></p>
</blockquote>
<p>命令行选项<br>–summary 显示概要信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt --summary  r0*.ccc.zzzc.qihoo.net test.ping</span><br></pre></td></tr></table></figure></p>
<p>指定输出格式–out<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt --out=json minion-01 test.ping</span><br></pre></td></tr></table></figure></p>
<p>目标机器匹配<br>-G grains -I pillar -N nodegroup -E 正则表达式 -L list<br>modules.func<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">test.ping </span><br><span class="line">cmd.run</span><br><span class="line">cmd.run_all</span><br><span class="line">pkg.install</span><br><span class="line">pkg.version</span><br><span class="line">pkg.remove</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>3、编写modules</strong></p>
</blockquote>
<p>目录在master的/srv/salt/_modules 下<br>编写cass.py<br>里面定义pwd()函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">def pwd():</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        Get pwd</span><br><span class="line"></span><br><span class="line">        CLI Example:</span><br><span class="line"></span><br><span class="line">        .. code-block:: bash</span><br><span class="line"></span><br><span class="line">            salt &apos;*&apos; cass.pwd</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">        cmd = &apos;pwd&apos;</span><br><span class="line">        r = subprocess.Popen(cmd,shell=True,stdout=subprocess.PIPE,stderr=subprocess.PIPE)</span><br><span class="line">        result = r.wait()</span><br><span class="line">        #r = __salt__[&apos;cmd.run_stdout&apos;](cmd)</span><br><span class="line">	#res = []</span><br><span class="line">	#for line in r.splitlines():</span><br><span class="line">	#	res.append(line)</span><br><span class="line">	#return res</span><br><span class="line">        if result == 0:</span><br><span class="line">		return r.stdout.read()</span><br><span class="line">        else:</span><br><span class="line">                return False</span><br></pre></td></tr></table></figure></p>
<p>master上执行同步命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*&apos; saltutil.sync_modules</span><br></pre></td></tr></table></figure></p>
<p>则同步到minion的cache下<br>/var/cache/salt/minion/extmods/modules<br>在master上就可以调用modules<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt ‘*’ cass.pwd</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>4、同步文件</strong></p>
</blockquote>
<p>文件：file.managed<br>目录：file.directory<br>文件夹：file.recurse</p>
<blockquote>
<p><strong>5、设置grains</strong></p>
</blockquote>
<p>两种方式</p>
<p>1)通过grains_modules,在master上mkdir /srv/salt/_grains<br>vim my_modules.py<br>执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*&apos; saltutil.sync_all</span><br></pre></td></tr></table></figure></p>
<p>重载modules<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*&apos; sys.reload_modules</span><br></pre></td></tr></table></figure></p>
<p>获取<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*&apos; grains.item grans-name</span><br></pre></td></tr></table></figure></p>
<p>2)在minion端配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim  /etc/salt/minion.d/grain.conf  #进行添加</span><br></pre></td></tr></table></figure></p>
<p>重启minion<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service salt-minion restart </span><br><span class="line">#or centos 7</span><br><span class="line">systemctl restart salt-minion.service</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>6、设置pillar</strong></p>
</blockquote>
<p>1）、在master新建目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /srv/pillar</span><br></pre></td></tr></table></figure></p>
<p>所有的pillar都放到这个目录下<br>2）、编写测试pillar<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /srv/pillar/test</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat /srv/pillar/test/token.sls</span><br><span class="line">roles: cassandra</span><br><span class="line">vim /srv/pillar/top.sls</span><br><span class="line">base:</span><br><span class="line">  &apos;*&apos;:</span><br><span class="line">    - test.token</span><br></pre></td></tr></table></figure>
<p>3）、刷新pillar<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*’ saltutil.refresh_pillar</span><br></pre></td></tr></table></figure></p>
<p>4）、查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt &apos;*’ pillar.items</span><br></pre></td></tr></table></figure></p>
<p>5）、使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- source: salt://cldisk4_zzzc/&#123;&#123;pillar[&apos;roles&apos;]&#125;&#125;/conf/features.low.yaml</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>7、执行highstate</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salt ‘*’ state.highstate</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong>推荐一个管理salt的界面化的管理端</strong><br><a href="https://github.com/yueyongyue/saltshaker" target="_blank" rel="noopener">https://github.com/yueyongyue/saltshaker</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/23/python-执行shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/23/python-执行shell/" itemprop="url">python 执行shell</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-23T22:18:35+08:00">
                2019-09-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>python执行shell</p>
<blockquote>
<p>1、os.system(cmd)</p>
</blockquote>
<p>只有返回值，没有命令返回值，如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">result = os.system(&apos;ls -l&apos;)</span><br><span class="line">print(result) #没有ls -l的结果，只有$?的结果</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>2、os.popen(cmd)</p>
</blockquote>
<p>只有cmd执行的结果，无$?结果，并且如果想要得到cmd的结果需要使用read或()readlines()方法，因为返回的是file类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">result = os.popen(&apos;ls -l&apos;)</span><br><span class="line">print(result.readlines())</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>3、commands.getstatusouput(cmd)</p>
</blockquote>
<p>既有cmd的返回值，又有$?的结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import commands</span><br><span class="line">output, result = commands.getstatusoutput(&apos;ls -l&apos;)</span><br><span class="line">print(output)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>4、subprocess.Popen(cmd)</p>
</blockquote>
<p>功能强大，但是需要学习才会用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">r = subprocess.Popen(&apos;ls -l&apos;, shell=True, stdout=subprocess.PIPE,stderr=subprocess.PIPE)</span><br><span class="line">result = r.wait()</span><br><span class="line">print(result)  # $?</span><br><span class="line">print(r.stdout.read())  # output</span><br><span class="line">print(r.stderr.read())  # err output</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/31/raft协议/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/31/raft协议/" itemprop="url">raft协议</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-31T19:44:12+08:00">
                2019-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>raft协议</p>
<blockquote>
<p>在分布式系统中，有许多一致性协议，如2pc、3pc、paxos、raft等<br>paxos由于难理解和难以实现到实际的应用中，所以此笔记来简单说下raft协议</p>
</blockquote>
<blockquote>
<p>raft协议主要包含3部分内容：1、leader选举；2、log复制；3、安全性；（第3部分我没看）</p>
</blockquote>
<ul>
<li>leader选举</li>
</ul>
<blockquote>
<p>raft中有3中状态：follower、candidate、leader<br>2个timeout：election timeout、heartbeat timeout</p>
</blockquote>
<blockquote>
<p>刚了解raft协议的时候，简单的认为，如果leader挂了，投票得到多的就可以当做leader，等到了解到log复制这部分的时候，明白了选主不是那么简单的，因为raft中的leader负责所有的读和写请求，所以不是所有candidate都可以选为leader</p>
</blockquote>
<blockquote>
<p>我们先看下简单的leader选举过程：<br>raft刚启动的时候，大家都是follower状态，每个follower上面都有一个election timeout，当这个超时时间达到后：<br>follower–&gt;candidate<br>变candidate后，首先将自己的term（为了区分leader的任期，只要term一样，leader是同一个）加1，并且为自己投自己一票（小时候选班委的时候也干过。。。），并发给其他节点，收到投票请求的节点，判断发现term比自己的大，就会变为follower并投票给他，当candidate收到的选票大于大多数的时候：<br>candidate–&gt;leader<br>变为leader状态</p>
</blockquote>
<blockquote>
<p>有一种情况是出现网络分区的时候<br>A  B | C D E<br>以上5个节点，A和B 可以通信，C、D、E可以通信<br>A和B会election timeout后term会一直增加，因为一直没有收到heartbeat，而C、D、E会顺利选出leader，并且可以对外提供服务，但当某时刻，网络又通了，此时由于A和B的term比C、D、E的大，此时会选A或B为leader，之前commit的log就会有问题，所以raft对此有一个优化，就是在选举之前，会进入preVote，提前和集群中的大多数进行一次通信，询问下是否可以选举，如果其他节点有leader或是收不到请求，是不会同意进行选举的，这时的term就不会一直增加</p>
</blockquote>
<ul>
<li>log复制</li>
</ul>
<blockquote>
<p>client每次进行操作都是经过leader，如果发送给follower，也会返回leader，让去请求leader；当leader收到请求后，首先更新自己的日志，然后发送append Entries到其他节点，如果大多数都成功了，则发送commit，表示已经commited，收到确认后，然后返回给客户端，并更新状态机（我理解为db）</p>
</blockquote>
<blockquote>
<p>如果出现上面提到的网络分区，A之前是leader，当收到更新请求时，并不能commit，最后会维持uncommitted状态；CDE三台由于election timeout发生选举并成功选出leader提供服务，并commit了log；等网络恢复的时候，会将A和B没有commit的日志覆盖</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/10/实现LRU缓存/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/10/实现LRU缓存/" itemprop="url">实现LRU缓存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-10T17:04:14+08:00">
                2019-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><em>LRU 缓存机制 设计和实现一个 LRU（最近最少使用）缓存数据结构，使它应该支持一下操作：get 和 put。 get(key) - 如果 key 存在于缓存中，则获取 key 的 value（总是正数），否则返回 -1。 put(key,value) - 如果 key 不存在，请设置或插入 value。当缓存达到其容量时，它应该在插入新项目之前使最近最少使用的项目作废。</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class LRUCache(object):</span><br><span class="line">    def __init__(self, capacity):</span><br><span class="line">        self.capacity = capacity</span><br><span class="line">        self.cache = &#123;&#125;</span><br><span class="line">        self.key = []</span><br><span class="line"></span><br><span class="line">    def get(self, key):</span><br><span class="line">        if key not in self.key:</span><br><span class="line">            return -1</span><br><span class="line">        self.key.remove(key)</span><br><span class="line">        self.key.append(key)</span><br><span class="line">        return self.cache[key]</span><br><span class="line"></span><br><span class="line">    def put(self, key, value):</span><br><span class="line">        if self.capacity == len(self.key):</span><br><span class="line">            del self.cache[self.key[0]]  #first</span><br><span class="line">            del self.key[0]              #second</span><br><span class="line">        self.cache[key] = value</span><br><span class="line">        self.key.append(key)</span><br></pre></td></tr></table></figure></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/12/hadoop使用笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/12/hadoop使用笔记/" itemprop="url">hadoop使用笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-12T12:01:13+08:00">
                2019-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记录安装hadoop的遇到的问题：<br>1、启动hdfs后，发现没有可用空间，查看Hadoop日志<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2019-07-10 21:36:25,598 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: Block pool BP-1879137787-10.208.38.101-1562765566027 (Datanode Uuid null) service to r13.xxx.xxx.qihoo.net/10.xxx.xxx.101:9000 beginning handshake with NN</span><br><span class="line">2019-07-10 21:36:25,599 ERROR org.apache.hadoop.hdfs.server.datanode.DataNode: Initialization failed for Block pool BP-1879137787-10.208.38.101-1562765566027 (Datanode Uuid null) service to xxx.qihoo.net/10.xxx.xxx.101:9000 Datanode denied communication with namenode because hostname cannot be resolved (ip=10.xxx.xxx.102, hostname=10.xxx.xxx.102): DatanodeRegistration(0.0.0.0:50010, datanodeUuid=14059f87-f157-4e59-9e00-519c1a181268, infoPort=50075, infoSecurePort=0, ipcPort=50020, storageInfo=lv=-56;cid=CID-aa688e9f-0daa-4de0-a210-7049b52cb75a;nsid=77792383;c=0)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.blockmanagement.DatanodeManager.registerDatanode(DatanodeManager.java:873)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.registerDatanode(FSNamesystem.java:4529)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.registerDatanode(NameNodeRpcServer.java:1286)</span><br><span class="line">	at org.apache.hadoop.hdfs.protocolPB.DatanodeProtocolServerSideTranslatorPB.registerDatanode(DatanodeProtocolServerSideTranslatorPB.java:96)</span><br><span class="line">	at org.apache.hadoop.hdfs.protocol.proto.DatanodeProtocolProtos$DatanodeProtocolService$2.callBlockingMethod(DatanodeProtocolProtos.java:28752)</span><br><span class="line">	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)</span><br><span class="line">	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:982)</span><br><span class="line">	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2049)</span><br><span class="line">	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2045)</span><br><span class="line">	at java.security.AccessController.doPrivileged(Native Method)</span><br><span class="line">	at javax.security.auth.Subject.doAs(Subject.java:422)</span><br><span class="line">	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1698)</span><br><span class="line">	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2043)</span><br></pre></td></tr></table></figure></p>
<p>通过问google大大增加配置<br>通过在hdfs-site.xml中增加如下配置，然后重启服务即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt; </span><br><span class="line">    &lt;name&gt;dfs.namenode.datanode.registration.ip-hostname-check&lt;/name&gt; </span><br><span class="line">    &lt;value&gt;false&lt;/value&gt; </span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></p>
<p>2、hadoop执行streaming命令<br>之前执行streaming，都是执行hadoop streaming balala~<br>发现新搭的集群不能直接执行，需要按照如下方式执行，找到对应的share/hadoop/tools/lib/hadoop-streaming-2.7.3.jar jar包，然后执行mr<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /home/xitong/hadoop-2.7.3/share/hadoop/tools/lib/hadoop-streaming-2.7.3.jar \</span><br><span class="line">-input /tmp/yutong/test-1 \</span><br><span class="line">-output /tmp/output \</span><br><span class="line">-mapper /bin/cat \</span><br><span class="line">-reducer /usr/bin/wc</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/26/python实现二分查找/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/26/python实现二分查找/" itemprop="url">python实现二分查找</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-26T22:01:14+08:00">
                2019-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>两种方式实现：</p>
<blockquote>
<p>二分查找的前提是要查找的列表已经是排过序的列表<br>1、使用循环方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def binary_find(rlist, data):</span><br><span class="line">    len_ = len(rlist)</span><br><span class="line">    left = 0</span><br><span class="line">    right = len_ - 1</span><br><span class="line">    while left &lt; right:</span><br><span class="line">        mid = (left + right) / 2 </span><br><span class="line">        if rlist[mid] &gt; data:</span><br><span class="line">            right = mid - 1</span><br><span class="line">        elif rlist[mid] &lt; data:</span><br><span class="line">            left = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            return True</span><br><span class="line">    return False</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>2、递归实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def binary_recursion(rlist, data):</span><br><span class="line">    len_ = len(rlist)</span><br><span class="line">    left = 0</span><br><span class="line">    right = len_ - 1</span><br><span class="line">    if len_ &lt; 1:</span><br><span class="line">        return False</span><br><span class="line">    mid = (left + right) / 2</span><br><span class="line">    if rlist[mid] &gt; data:</span><br><span class="line">        return binary_recursion(rlist[0:mid], data)</span><br><span class="line">    elif rlist[mid] &lt; data:</span><br><span class="line">        return binary_recursion(rlist[mid+1:], data)</span><br><span class="line">    else:</span><br><span class="line">        return True</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/17/mac-os-linux-使用sshfs挂载远程服务器的目录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/17/mac-os-linux-使用sshfs挂载远程服务器的目录/" itemprop="url">mac os/linux 使用sshfs挂载远程服务器的目录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-17T10:41:10+08:00">
                2019-06-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>mac os</strong><br>1、由于sshfs依赖于fuse<br>所以需要下载fuse</p>
<blockquote>
<p><a href="https://github.com/osxfuse/osxfuse/releases" target="_blank" rel="noopener">https://github.com/osxfuse/osxfuse/releases</a></p>
</blockquote>
<p>2、安装sshfs</p>
<blockquote>
<p><a href="https://github.com/osxfuse/sshfs/releases" target="_blank" rel="noopener">https://github.com/osxfuse/sshfs/releases</a></p>
</blockquote>
<p>3、挂载即可</p>
<blockquote>
<p>sshfs -o reconnect -o password_stdin [remote-user]@[remote_server]:/data05/yt  /Users/yut/mnt<br>sshfs 用户名@远程主机IP:远程主机路径 本地挂载点</p>
</blockquote>
<p><strong>linux</strong><br>centos<br>1、安装fuse和sshfs</p>
<blockquote>
<p>yum install -y fuse sshfs</p>
</blockquote>
<p>2、挂载</p>
<blockquote>
<p>sshfs -o reconnect -o password_stdin [remote-user]@[remote_server]:/data05/yt  /Users/yut/mnt<br>sshfs 用户名@远程主机IP:远程主机路径 本地挂载点</p>
</blockquote>
<p>报错：<br>fuse: failed to exec fusermount: Permission denied<br>解决：</p>
<blockquote>
<p>chmod +x /usr/bin/fusermount</p>
</blockquote>
<p>免密挂载</p>
<p>#ssh-keygen -t rsa </p>
<p>#cat .ssh/id_rsa.pub | ssh [remote_user]@[remote_server] “cat - &gt;&gt;.ssh/authorized_keys”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/15/redis总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/15/redis总结/" itemprop="url">redis总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-15T23:34:44+08:00">
                2019-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>redis总结</p>
<p>redis是nosql的数据库，常用于作为缓存用，和memcache相比，他具有更多的数据格式</p>
<blockquote>
<p>redis的五种数据格式<br>string、list、set、zset、hash</p>
</blockquote>
<p>1、string</p>
<blockquote>
<p>string是key-value存储形式，底层实现是sds，不是c语言的字符串<br>常用的命令如下：<br>set、get、mset、mget</p>
</blockquote>
<p>2、set</p>
<blockquote>
<p>set的key和string里的key一样，value是多个不重复的值，且没有顺序<br>常用命令如下：<br>sadd、scard、smembers、spop、sdiff、sunion</p>
</blockquote>
<p>3、list</p>
<blockquote>
<p>list是一种双向链表，有序也可以重复（zset有序，不能重复），底层使用链表实现<br>常用命令如下：<br>lpush、lpop、rpop、rpush、lrange、llen</p>
</blockquote>
<p>4、hash</p>
<blockquote>
<p>hash 的key也是和string里的key一样，value是多个key-value的格式，底层实现是哈希表<br>常用命令如下：<br>hset、hget、hgetall、hkeys、hvals</p>
</blockquote>
<p>5、zset</p>
<blockquote>
<p>zset相比于set，除了不能重复外，他是有序的，但是要比list复杂，当作有序列表的话，效率要比list低，底层使用跳跃表实现<br>常用命令如下：<br>zadd、zcard、zrange</p>
</blockquote>
<p>key相关的命令</p>
<blockquote>
<p>删除key<br>del key<br>加过期时间<br>expire seconds key<br>取消过期时间<br>persist key<br>匹配key<br>keys *<br>查看还剩多长时间过期<br>ttl key</p>
</blockquote>
<p>使用案例</p>
<blockquote>
<p>有这样多程序，需要从公共的一份数据里去拿自己的想要的数据，要解决并发冲突的问题，如果取到数据自己可以处理，则处理完继续去取数据，如果取出的数据自己无法处理，则通过rpush继续将此数据插入到列表里，供其他程序处理；此时就可以使用redis的list格式的数据</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/lvm（logical-volume-manager-逻辑卷管理）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/14/lvm（logical-volume-manager-逻辑卷管理）/" itemprop="url">lvm（logical volume manager 逻辑卷管理）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-14T18:17:42+08:00">
                2019-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>lvm（logical volume manager 逻辑卷管理）<br>组成成员<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">pv[pv pv pv pv pv] --&gt;|组成| D[VG]</span><br><span class="line">D --&gt;|组成| F[lv /home /user]</span><br></pre></td></tr></table></figure></p>
<p>过程：pv - &gt; vg - &gt; lv<br>类似：分 - &gt; 合 - &gt; 分</p>
<blockquote>
<p>pv<br>pv为物理卷，可以是整个磁盘，也可以是磁盘的分区，是lvm的最底层，所有加入lvm前都要创建pv</p>
</blockquote>
<blockquote>
<p>vg<br>vg为卷组，将多个pv组成卷组进行管理，</p>
</blockquote>
<blockquote>
<p>lv<br>lv是逻辑卷，lv就是在vg里进行分配，可以将分配的lv挂到某个目录下<br>可以进行格式化等</p>
</blockquote>
<p>分配lv的过程</p>
<blockquote>
<p>1、分区<br>2、创建pv<br>3、创建vg<br>4、分配lv<br>5、格式化lv<br>6、挂载<br>6、写入fstab</p>
</blockquote>
<p>实际例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、lvcreate -n &lt;lv的名字&gt; -l &lt;大小&gt; &lt;要从哪个vg里分&gt;</span><br><span class="line">lvcreate -n LogVol04 -l 100%free VolGroup00</span><br><span class="line"></span><br><span class="line">2、格式化lv</span><br><span class="line">/sbin/mkfs.xfs /dev/mapper/VolGroup00-LogVol04</span><br><span class="line"></span><br><span class="line">3、写入fstab</span><br><span class="line">echo &quot;/dev/VolGroup00/LogVol04 /meta01 xfs defaults 1 2&quot; &gt;&gt; /etc/fstab</span><br><span class="line"></span><br><span class="line">4、挂载到meta01</span><br><span class="line">mkdir /meta01 &amp;&amp; mount -a</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/05/python装饰器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yutong-it">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/05/python装饰器/" itemprop="url">python装饰器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-05T22:30:57+08:00">
                2019-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1、什么语言可以使用装饰器？</p>
<blockquote>
<p>当一个函数可以当做参数来传递时，可以使用装饰器</p>
</blockquote>
<p>2、下面写一个用来计算函数执行时间的装饰器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">def timmer(func):</span><br><span class="line">    def inner(*args, **kwargs):</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        res = func(*args, **kwargs)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        print(&quot;spent time: %s&quot; % (end_time - start_time))</span><br><span class="line">        return res</span><br><span class="line">    return inner</span><br></pre></td></tr></table></figure></p>
<p>3、装饰器的调用</p>
<blockquote>
<p>装饰器可以不修改原函数的调用方式，参数，不用修改原函数；还是原来的函数名，直接调用；可以用2种方式使用装饰器</p>
</blockquote>
<blockquote>
<p>1.直接调用</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def p_print(string):</span><br><span class="line">    print(&quot;This is in p_print &quot; + str(string))</span><br><span class="line"></span><br><span class="line">p_print = timmer(p_print) // 原函数名 = timmer(原函数名）</span><br><span class="line">p_print(&apos;111&apos;)           // 调用还是 ：  原函数名(参数)</span><br><span class="line">p_print(&apos;112&apos;)</span><br></pre></td></tr></table></figure>
<p>执行结果</p>
<blockquote>
<p>This is in p_print 111<br>spent time: 7.15255737305e-06<br>This is in p_print 112<br>spent time: 4.05311584473e-06</p>
</blockquote>
<p>2.python提供使用“@装饰器”的形式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@timmer</span><br><span class="line">def p_print(string):</span><br><span class="line">    print(&quot;This is in p_print &quot; + str(string))</span><br><span class="line"></span><br><span class="line">p_print(&apos;111&apos;)           // 调用还是 ：  原函数名(参数)</span><br><span class="line">p_print(&apos;112&apos;)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>执行结果<br>This is in p_print 111<br>spent time: 6.91413879395e-06<br>This is in p_print 112<br>spent time: 4.05311584473e-06</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
